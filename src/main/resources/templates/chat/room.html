<div class="chat">
    <form action="https://www.naver.com" onSubmit="Chat_submitWriteMessageForm(this); return false;">
        <input name="authorName" type="text" placeholder="작성자">
        <input name="content" type="text" placeholder="내용">
        <input type="submit" value="작성">
    </form>

    <div class="chat__messageBox">
        <ul class="chat__message-ul">

        </ul>

    </div>

    <button onClick="Chat__loadMore();">로드</button>
</div>

<script>
    // ajax 유틸
function fetchPost(url, data) {
    return fetch(url, {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            Accept: "application/json"
        },
        body: JSON.stringify(data)
    }).then((response) => response.json());
}

function fetchGet(url, data) {
    let query = Object.keys(data)
        .map((k) => encodeURIComponent(k) + "=" + encodeURIComponent(data[k]))
        .join("&");

    return fetch(url + "?" + query, {
        method: "GET",
        headers: {
            "Content-Type": "application/json",
            Accept: "application/json"
        }
    }).then((response) => response.json());
}
</script>
<script>
    // 채팅 작성 폼
    function Chat_submitWriteMessageForm(form) {
        // console.log('Chat_submitWriteMessageForm 실행됨');
        form.authorName.value = form.authorName.value.trim();

        if (form.authorName.value.length == 0) {
            form.authorName.focus();
            alert("작성자 누구임??");
            return;
        }

        form.content.value = form.content.value.trim();

        if (form.content.value.length == 0) {
            form.content.focus();
            alert("내용 뭐임??");
            return;
        }

        fetchPost("/chat/writeMessage", {
            authorName: form.authorName.value,
            content: form.content.value
        }).then((data) => console.log(data));

        form.content.value = "";
        form.content.focus();
    }


</script>